import{r as d,j as e}from"./app-D1e81X8p.js";const C=({drivers:b,barangays:h,schedules:c})=>{const[n,p]=d.useState(""),[l,g]=d.useState("today"),[x,y]=d.useState([]),[f,u]=d.useState(!1);d.useEffect(()=>{if(!n){y([]);return}u(!0);let t=c.filter(s=>s.barangay_id==n);const r=new Date,a=new Date(r.getFullYear(),r.getMonth(),r.getDate());switch(l){case"today":t=t.filter(i=>new Date(i.collection_date).toDateString()===a.toDateString());break;case"week":const s=new Date(a);s.setDate(a.getDate()-a.getDay());const m=new Date(s);m.setDate(s.getDate()+6),t=t.filter(i=>{const o=new Date(i.collection_date);return o>=s&&o<=m});break;case"month":const k=new Date(r.getFullYear(),r.getMonth(),1),S=new Date(r.getFullYear(),r.getMonth()+1,0);t=t.filter(i=>{const o=new Date(i.collection_date);return o>=k&&o<=S});break}y(t),u(!1)},[n,l,c]);const w=t=>{if(!t)return"N/A";try{return new Date(t).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})}catch{return"Invalid Date"}},j=t=>{if(!t)return"N/A";try{const[r,a]=t.split(":").map(Number),s=r>=12?"PM":"AM";return`${r%12||12}:${a.toString().padStart(2,"0")} ${s}`}catch{return t}},v=t=>{const r=c.find(s=>s.driver_id==t);if(r&&r.driver&&r.driver.user)return`${r.driver.user.name} ${r.driver.user.lastname}`;const a=b.find(s=>s.id==t);return a&&a.user?`${a.user.name} ${a.user.lastname}`:"Unknown Driver"},N=t=>{const a={progress:{color:"bg-yellow-50 text-yellow-700 border-yellow-200",label:"Pending"},active:{color:"bg-blue-50 text-blue-700 border-blue-200",label:"Active"},inactive:{color:"bg-gray-50 text-gray-700 border-gray-200",label:"Inactive"},completed:{color:"bg-green-50 text-green-700 border-green-200",label:"Completed"},failed:{color:"bg-red-50 text-red-700 border-red-200",label:"Failed"}}[t]||{color:"bg-gray-50 text-gray-700 border-gray-200",label:t};return e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium border ${a.color}`,children:a.label})},D=t=>{const r=c.find(s=>s.barangay_id==t);if(r&&r.barangay)return r.barangay.baranggay_name;const a=h.find(s=>s.id==t);return a?a.baranggay_name:"Unknown Barangay"};return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200",children:[e.jsx("div",{className:"px-6 py-5 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-base font-semibold text-gray-900",children:"Collection Schedules"}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:"View and manage collection schedules by barangay"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("div",{className:"w-full sm:w-64",children:e.jsxs("select",{id:"barangay",value:n,onChange:t=>p(t.target.value),className:"w-full text-sm rounded-md border-gray-300 shadow-sm focus:border-gray-900 focus:ring-gray-900",children:[e.jsx("option",{value:"",children:"Select barangay"}),h.map(t=>e.jsx("option",{value:t.id,children:t.baranggay_name},t.id))]})}),e.jsxs("div",{className:"inline-flex rounded-md shadow-sm",role:"group",children:[e.jsx("button",{type:"button",onClick:()=>g("today"),className:`px-4 py-2 text-xs font-medium border ${l==="today"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"} rounded-l-md transition-colors`,children:"Today"}),e.jsx("button",{type:"button",onClick:()=>g("week"),className:`px-4 py-2 text-xs font-medium border-t border-b ${l==="week"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"} transition-colors`,children:"This Week"}),e.jsx("button",{type:"button",onClick:()=>g("month"),className:`px-4 py-2 text-xs font-medium border ${l==="month"?"bg-gray-900 text-white border-gray-900":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"} rounded-r-md transition-colors`,children:"This Month"})]})]})]})}),e.jsx("div",{className:"p-6",children:n?f?e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No schedules found"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["No collection schedules found for ",D(n)," in the selected time period"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-900 uppercase tracking-wider bg-gray-50",children:"Driver"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-900 uppercase tracking-wider bg-gray-50",children:"Collection Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-900 uppercase tracking-wider bg-gray-50",children:"Collection Time"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-900 uppercase tracking-wider bg-gray-50",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-semibold text-gray-900 uppercase tracking-wider bg-gray-50",children:"Notes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(t=>{var r;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:v(t.driver_id)}),e.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:["License: ",((r=t.driver)==null?void 0:r.license_number)||"N/A"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:w(t.collection_date)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:j(t.collection_time)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:N(t.status)}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs",children:e.jsx("div",{className:"truncate",title:t.notes,children:t.notes||"â€”"})})]},t.id)})})]})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 flex justify-between items-center text-sm text-gray-500",children:[e.jsxs("div",{children:["Showing ",e.jsx("span",{className:"font-medium text-gray-900",children:x.length})," schedule",x.length!==1?"s":""]}),e.jsxs("div",{children:["Last updated: ",new Date().toLocaleTimeString()]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No barangay selected"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Select a barangay above to view collection schedules"})]})})]})};export{C as default};
