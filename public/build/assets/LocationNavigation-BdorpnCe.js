import{J as Fe,r as s,j as e,S as i}from"./app-MsNDmXnr.js";import{F as y}from"./FormModal-DpFV4fPK.js";import{P as G}from"./PrimaryButton-DrdN4ODv.js";import{G as Ce}from"./iconBase-SbOlHqN9.js";import{b as j}from"./index-uXRvpCua.js";import{F as U}from"./index-BYeEXS_4.js";import{a as Y}from"./index-DaFwudAB.js";import{s as t,c as J}from"./SweetAlert-BCVjw1BF.js";import"./TextInput-D5tHPmzr.js";function L(l){return Ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M363 277h-86v86h-42v-86h-86v-42h86v-86h42v86h86v42z"},child:[]},{tag:"path",attr:{d:"M256 90c44.3 0 86 17.3 117.4 48.6C404.7 170 422 211.7 422 256s-17.3 86-48.6 117.4C342 404.7 300.3 422 256 422c-44.3 0-86-17.3-117.4-48.6C107.3 342 90 300.3 90 256c0-44.3 17.3-86 48.6-117.4C170 107.3 211.7 90 256 90m0-42C141.1 48 48 141.1 48 256s93.1 208 208 208 208-93.1 208-208S370.9 48 256 48z"},child:[]}]})(l)}function qe(){const{municipalities:l=[],baranggays:p=[],puroks:g=[]}=Fe().props,[d,c]=s.useState("municipality"),[O,H]=s.useState(""),[K,Q]=s.useState(null),[k,V]=s.useState(null),[W,X]=s.useState(""),[Z,S]=s.useState(null),[ee,ae]=s.useState(l),[se,te]=s.useState(p),[re,ne]=s.useState(g);s.useEffect(()=>ae(l),[l]),s.useEffect(()=>te(p),[p]),s.useEffect(()=>ne(g),[g]);const[P,N]=s.useState(!1),[B,v]=s.useState(!1),[w,E]=s.useState(!1),[F,C]=s.useState(!1),[ie,A]=s.useState(!1),[D,M]=s.useState(!1),[u,_]=s.useState(null),[oe,T]=s.useState(!1),[$,z]=s.useState(!1),[m,I]=s.useState(null),R=s.useMemo(()=>[{name:"baranggay_name",label:"Barangay Name",type:"text",required:!0},{name:"type",label:"Type",type:"select",options:[{value:"Urban",label:"Urban"},{value:"Rural",label:"Rural"}],required:!0}],[]),q=s.useMemo(()=>[{name:"purok_name",label:"Purok Name",type:"text",required:!0}],[]),le=R,de=q,[ce,x]=s.useState({}),[ue,h]=s.useState({}),[me,b]=s.useState({}),[ye,f]=s.useState({}),pe=()=>{x({}),N(!0)},ge=()=>{N(!1),x({})},xe=()=>{h({}),E(!0)},he=()=>{E(!1),h({})},be=a=>{I(a),b({baranggay_name:a.baranggay_name,type:a.type}),T(!0)},fe=()=>{T(!1),I(null),b({})},je=a=>{_(a),f({purok_name:a.purok_name}),A(!0)},ke=()=>{A(!1),_(null),f({})},Se=a=>new Promise((r,o)=>{v(!0),i.post("/municipality/baranggay/addBarangay",{...a,municipality_id:K},{onSuccess:()=>{t("success","Barangay added successfully"),r()},onError:n=>{console.error(n),t("error","Failed to add barangay"),o(n)},onFinish:()=>{v(!1)}})}),Pe=a=>new Promise((r,o)=>{C(!0),i.post("/municipality/baranggay/purok/addPurok",{...a,baranggay_id:k},{onSuccess:()=>{t("success","Purok added successfully"),r()},onError:n=>{t("error","Failed to add purok"),o(n)},onFinish:()=>C(!1)})}),Ne=a=>new Promise((r,o)=>{z(!0),i.put(`/municipality/barangay/editBarangay/${k}`,a,{onSuccess:()=>{t("success","Barangay updated successfully"),r()},onError:n=>{t("error","Failed to update barangay"),o(n)},onFinish:()=>z(!1)})}),Be=a=>new Promise((r,o)=>{M(!0),i.put(`/municipality/barangay/editPurok/${Z}`,a,{onSuccess:()=>{t("success","Purok updated successfully"),r()},onError:n=>{t("error","Failed to update purok"),o(n)},onFinish:()=>M(!1)})}),ve=async a=>{await J("Are you sure?","This will delete the barangay permanently!","Yes, delete it")&&i.delete(`/municipality/barangay/${a}/delete`,{onSuccess:()=>t("success","Barangay deleted successfully"),onError:()=>t("error","Failed to delete barangay")})},we=async a=>{await J("Are you sure?","This will delete the purok permanently!","Yes, delete it")&&i.delete(`/municipality/barangay/purok/${a}/delete`,{onSuccess:()=>t("success","Purok deleted successfully"),onError:()=>t("error","Failed to delete purok")})},Ee=()=>{switch(d){case"municipality":return e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Municipality"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Barangays"}),e.jsx("th",{className:"px-6 py-3",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ee.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:a.municipality_name}),e.jsx("td",{className:"px-6 py-4",children:a.baranggays_count}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("button",{onClick:()=>{H(a.municipality_name),Q(a.id),i.get(`/municipalities/${a.id}/barangay`,{},{preserveState:!0,replace:!0}),c("barangay")},className:"text-gray-600 hover:text-blue-600",children:e.jsx(j,{size:20})})})]},a.id))})]})});case"barangay":return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("button",{onClick:()=>c("municipality"),className:"text-blue-500",children:"← Back"}),e.jsxs(G,{onClick:pe,children:[e.jsx(L,{className:"mr-2"})," Add Barangay"]})]}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3",children:"Barangay"}),e.jsx("th",{className:"px-6 py-3",children:"Puroks"}),e.jsx("th",{className:"px-6 py-3",children:"Type"}),e.jsx("th",{className:"px-6 py-3",children:"Actions"})]})}),e.jsx("tbody",{children:se.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:a.baranggay_name}),e.jsx("td",{className:"px-6 py-4",children:a.puroks_count}),e.jsx("td",{className:"px-6 py-4",children:a.type}),e.jsxs("td",{className:"px-6 py-4 flex gap-2",children:[e.jsx("button",{onClick:()=>{V(a.id),X(a.baranggay_name),i.get(`/baranggay/${a.id}/purok`,{},{preserveState:!0,replace:!0}),c("purok")},className:"text-gray-600 hover:text-blue-600",children:e.jsx(j,{size:20})}),e.jsx("button",{onClick:()=>be(a),className:"text-gray-600 hover:text-green-600",children:e.jsx(Y,{size:20})}),e.jsx("button",{onClick:()=>ve(a.id),className:"text-red-600",children:e.jsx(U,{size:20})})]})]},a.id))})]})]});case"purok":return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("button",{onClick:()=>c("barangay"),className:"text-blue-500",children:"← Back"}),e.jsxs(G,{onClick:xe,children:[e.jsx(L,{className:"mr-2"})," Add Purok"]})]}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3",children:"Purok"}),e.jsx("th",{className:"px-6 py-3",children:"Actions"})]})}),e.jsx("tbody",{children:re.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:a.purok_name}),e.jsxs("td",{className:"px-6 py-4 flex gap-2",children:[e.jsx("button",{onClick:()=>S(a.id),className:"text-blue-600",children:e.jsx(j,{size:20})}),e.jsx("button",{onClick:()=>{S(a.id),je(a)},className:"text-green-600",children:e.jsx(Y,{size:20})}),e.jsx("button",{onClick:()=>we(a.id),className:"text-red-600",children:e.jsx(U,{size:20})})]})]},a.id))})]})]});default:return null}};return e.jsxs("div",{className:"py-6",children:[e.jsxs("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden p-6",children:[e.jsxs("h3",{className:"text-lg font-medium mb-4",children:[d==="municipality"&&"Municipalities",d==="barangay"&&`Barangays in ${O}`,d==="purok"&&`Puroks in ${W}`]}),Ee()]}),e.jsx(y,{show:P,onClose:ge,title:"Add Barangay",fields:R,onSubmit:Se,submitText:B?"Adding...":"Add Barangay",processing:B,formData:ce,onFormChange:x},`add-brgy-${P}`),e.jsx(y,{show:w,onClose:he,title:"Add Purok",fields:q,onSubmit:Pe,submitText:F?"Adding...":"Add Purok",processing:F,formData:ue,onFormChange:h},`add-purok-${w}`),e.jsx(y,{show:oe,onClose:fe,title:"Edit Barangay",initialData:m,fields:le,onSubmit:Ne,submitText:$?"Saving...":"Save Changes",processing:$,formData:me,onFormChange:b},`edit-brgy-${(m==null?void 0:m.id)||"none"}`),e.jsx(y,{show:ie,onClose:ke,title:"Edit Purok",initialData:u,fields:de,onSubmit:Be,submitText:D?"Saving...":"Save Changes",processing:D,formData:ye,onFormChange:f},`edit-purok-${(u==null?void 0:u.id)||"none"}`)]})}export{qe as default};
