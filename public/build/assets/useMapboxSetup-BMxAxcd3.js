import{r as a}from"./app-BOwIOK84.js";import{a as g}from"./mapbox-gl-CcLdEyCe.js";const z=({mapboxKey:d,isMobile:f})=>{const l=a.useRef(null),o=a.useRef(null),[p,h]=a.useState(!1),[m,i]=a.useState(!1),[S,n]=a.useState(null),[v,s]=a.useState(!1),[C,u]=a.useState(!navigator.onLine);return a.useEffect(()=>{(()=>{const e=document.createElement("link");return e.href="https://api.mapbox.com/mapbox-gl-js/v3.0.0/mapbox-gl.css",e.rel="stylesheet",e.onload=()=>{h(!0)},e.onerror=()=>{console.error("Failed to load Mapbox CSS"),n("Failed to load map styles")},document.head.appendChild(e),()=>{document.head.contains(e)&&document.head.removeChild(e)}})()},[]),{mapContainer:l,map:o,cssLoaded:p,mapInitialized:m,mapError:S,customStyleLoaded:v,offlineMode:C,setMapInitialized:i,setCustomStyleLoaded:s,setMapError:n,setOfflineMode:u,initializeMap:c=>{if(!(!p||!d||o.current||!l.current)){try{g.accessToken=d;const e=navigator.onLine;o.current=new g.Map({container:l.current,style:"mapbox://styles/makisenpai/cm9mo7odu006c01qsc3931nj7",center:[125.94849837776422,8.483022468128098],zoom:f?11:10.5,attributionControl:!1,interactive:!0,scrollZoom:!0,dragPan:!0,dragRotate:!1,keyboard:!1,doubleClickZoom:!f,touchZoomRotate:!0,touchPitch:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!0,maxTileCacheSize:50,refreshExpiredTiles:e,transformRequest:(r,t)=>!e&&t==="Tile"?{url:r,headers:{"Cache-Control":"max-age=86400"}}:{url:r}}),o.current.on("load",()=>{i(!0),s(!0),console.log("Map loaded and initialized"),c&&c()}),o.current.on("error",r=>{var t;if(console.error("Map error:",r),!navigator.onLine){console.warn("Map error suppressed - continuing in offline mode"),u(!0),n(null),m||(i(!0),s(!0));return}n("Failed to load map: "+((t=r.error)==null?void 0:t.message))}),o.current.on("dataloading",r=>{var t;navigator.onLine||(t=r.preventDefault)==null||t.call(r)}),o.current.on("sourcedataloading",r=>{var t;navigator.onLine||(t=r.preventDefault)==null||t.call(r)}),o.current.on("idle",()=>{})}catch(e){console.error("Error creating map:",e),navigator.onLine?n("Failed to initialize map: "+e.message):(console.warn("Map initialization error suppressed - offline mode"),u(!0),n(null),i(!0))}return()=>{o.current&&(o.current.remove(),o.current=null,i(!1),s(!1))}}}}};export{z as useMapboxSetup};
